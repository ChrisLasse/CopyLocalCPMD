#INFO#
#INFO# Configuration for Linux HPC (NEC) cluster Equip@Meso
#INFO# Intel Composer v.16 or later - OpenMPI + OMP 3.0 (or later)
#INFO# WARNING: The clause "collapse(n)" may not work in old compilers and
#INFO#          is known to have troubles on the Fujitsu compiler (K-computer
#INFO#          and Fujitsu FX10 machine) and Intel Fortran Compiler version
#INFO#          11 and former ones. Since ifort v.12.0.3 bugs have been fixed.
#INFO#          Please, refer to the discussion in
#INFO#          http://openmp.org/forum/viewtopic.php?f=3&t=1023&start=10
#INFO#          and check carefully your compiler and OS.
#INFO# For optimal performance you should use a specifically tuned BLAS/LAPACK
#INFO# library as in this specific configuration file 
#INFO# (IPCMS-University of Tokyo, January 2018). 
#INFO#
     IRAT=2
     FC='mpiifort'
     CC='mpiicc'
     LD='mpiifort'
     CPP='/lib/cpp -P -traditional'
     CPPFLAGS='  -D__HAS_FFT_DEFAULT -D__ALPHALINUX -D__HPC -D__HASNT_OMP_45 \
         -D__PARALLEL -D__HAS_SIZEOF -D__HAS_BF_STREAM_IO -D__HASNT_F08_ISO_FORTRAN_ENV'
     CPPFLAGS_GROMOS='-DEWALD -DEWATCUT -DHAT_SHAPE -DUNPACKED_GRID \
              -D__HAS_FFT_DEFAULT -D__ALPHALINUX -D__HPC -D__HASNT_OMP_45 \
             -D__PARALLEL -D__HAS_SIZEOF -D__HAS_BF_STREAM_IO -D__HASNT_F08_ISO_FORTRAN_ENV'
     FFLAGS_GROMOS='-fixed $(FFLAGS)'
     FFLAGS_GROMOS_MODULES=' $(FFLAGS)'
     AR='xiar -r'
     RANLIB='/usr/bin/ranlib'
     if [ $debug ]; then
       FFLAGS='-g'
       CFLAGS='-g -Wall -m64'
     else
       FFLAGS='-ipo -O3 -no-prec-div -pc64 -funroll-loops -fpp -heap-arrays 64'
       CFLAGS='-O3 -Wall  '
     fi
     MKLPATH='/opt/intel/compilers_and_libraries_2016.0.109/linux/mkl/lib/intel64_lin'
     if [ $omp ]; then
       FFLAGS=${FFLAGS}' -qopenmp'
       OMP3_DISABLED='false'
       LIBS='-mkl=parallel -lm'
     else
       LIBS='-static-intel -L$(MKLPATH) -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core \
             -lm -lpthread -liomp5 '
     fi
     LFLAGS=${LIBS}
